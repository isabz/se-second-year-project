<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<link rel="stylesheet" href="./css/mammal.css">
		<title></title>
    	<script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
		
		<!-- grab data and prepare charts -->
		<script>
			function datastring(object){
				for (const x in object){
					return x + ": " + object[x]
				}
			}
			
			function graphdata(array,str){
				let data = []
				for (let item in array){
					object = array[item];
					data.push({x: new Date(object.Year,0), y:object[str]})
				}
				console.log(data)
				return(data)
			}

			const xhttp = new XMLHttpRequest();

			xhttp.onload = function() {
				data = JSON.parse(this.responseText);
				console.log(data);
				document.getElementById("ds1").innerHTML = datastring(data[0][0]);
				document.getElementById("ds2").innerHTML = datastring(data[1][0]);
				document.getElementById("ds3").innerHTML = datastring(data[2][0]);
				document.getElementById("ds4").innerHTML = datastring(data[3][0]);
				line1 = graphdata(data[5],'Number of active users classifying');
				line2 = graphdata(data[4],'Number of active users uploading');
				var chart = new CanvasJS.Chart("chartContainer", {
					animationEnabled: true,
					theme: "light2",
					axisX:{
						crosshair: {
							enabled: true,
							snapToDataPoint: true
						}
					},
					axisY: {
						title: "Number of active users",
						includeZero: true,
						crosshair: {
							enabled: true
						}
					},
					toolTip:{
						shared:true
					},  
					legend:{
						cursor:"pointer",
						itemclick: toogleDataSeries
					},
					data: [{
						type: "line",
						showInLegend: true,
						name: "Number of active users classifying",
						markerType: "square",
						xValueFormatString: "YYYY",
						color: "#F08080",
						dataPoints: line1
					},
					{
						type: "line",
						showInLegend: true,
						name: "Number of active users uploading",
						markerType: "square",
						xValueFormatString: "YYYY",
						dataPoints: line2
					}]
				});
				chart.render();
				
				function toogleDataSeries(e){
					if (typeof(e.dataSeries.visible) === "undefined" || e.dataSeries.visible) {
						e.dataSeries.visible = false;
					} else{
						e.dataSeries.visible = true;
					}
					chart.render();
				}
			}

			xhttp.open("GET", "citsci");
			xhttp.send();

		</script>
		 <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
		        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
		        crossorigin="anonymous"></script>
	</head>
	<body id="main" class="kuang">
		<header>
			<nav class="kuang1">
				<ul>
					<li class="li"><a href="#">HOME</a></li>
					<li class="li"><a href="#">ABOUT</a></li>
					<li class="li"><a href="#">GET STARTED</a></li>
					<li class="li"><a href="#">PROJECTS</a></li>
					<li class="li"><a href="#">CONTRIBUTE</a></li>
					<li class="li"><a href="#">LEARN</a></li>
					<li class="li"><a href="#">COMMUNITY</a></li>
					<li class="li"><a href="#">LOGIN</a></li>
					<li class="li1"><a href="http://127.0.0.1:8848/kpi1.html">KPIS</a></li>
				</ul>				
			</nav>
<!-- 			<nav class="navbar navbar-expand-lg navbar-light bg-light">
			  <a class="navbar-brand" href="#">Navbar</a>
			  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
			    <span class="navbar-toggler-icon"></span>
			  </button>
			  <div class="collapse navbar-collapse" id="navbarNav">
			    <ul class="navbar-nav">
			      <li class="nav-item active">
			        <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
			      </li>
			      <li class="nav-item">
			        <a class="nav-link" href="#">Features</a>
			      </li>
			      <li class="nav-item">
			        <a class="nav-link" href="#">Pricing</a>
			      </li>
			      <li class="nav-item">
			        <a class="nav-link disabled" href="#">Disabled</a>
			      </li>
			    </ul>
			  </div>
			</nav> -->
			<nav class="kuang2">
				<ul>
					<li><a href="http://127.0.0.1:8848/kpi1.html">Citizen Scientists</a></li>
					<li><a href="http://127.0.0.1:8848/kpi2.html">Image Sequences</a></li>
					<li><a href="http://127.0.0.1:8848/kpi3.html">Classification</a></li>
					<li><a href="http://127.0.0.1:8848/kpi4.html">Data Coverage</a></li>
					<li><a href="http://127.0.0.1:8848/kpi5.html">Impact</a></li>
					<li><a href="http://127.0.0.1:8848/kpi6.html">Funding</a></li>
				</ul>
			</nav>
			<div class="da">
				<div class="ds1" id="ds1">data1</div>
				<div class="ds2" id="ds2">data2</div>
				<div class="ds3" id="ds3">data3</div>
				<div class="ds4" id="ds4"></div>
				<div class="ds5" id="ds5">
					<!-- line chart -->
					<div id="chartContainer" style="width: 100%;"></div>
				</div>
			</div>
			
		</header>
		<script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>

	</body>
</html>

